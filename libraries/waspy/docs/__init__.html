<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>__init__.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>__init__.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p><strong>Disclaimer </strong> please consider this is a preliminary version of the lib. It is undergoing many tests but also many changes,
so please be patient and do not trust anyone&rsquo;s life with the library (not yet)</p>
<h1>WASDI</h1>
<p>This is WASPY, the WASDI Python lib.</p>
<p>The methods in the module allow to interact with WASDI seamlessly.</p>
<p>Note:
the philosophy of safe programming is adopted as widely as possible, the lib will try to workaround issues such as
faulty input, and print an error rather than raise an exception, so that your program can possibly go on. Please check
the return statues</p>
<p>Created on 11 Jun 2018</p>
<p>@author: p.campanella</p>
<p>from pandas._libs.join import outer_join_indexer</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;wasdi&quot;</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">zipfile</span>

<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">m_sUser</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">m_sPassword</span> <span class="o">=</span> <span class="bp">None</span>

<span class="n">m_sActiveWorkspace</span> <span class="o">=</span> <span class="bp">None</span>

<span class="n">m_sParametersFilePath</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">m_sSessionId</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">m_bValidSession</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">m_sBasePath</span> <span class="o">=</span> <span class="bp">None</span>

<span class="n">m_bDownloadActive</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">m_bUploadActive</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">m_bVerbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">m_aoParamsDictionary</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">m_sMyProcId</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">m_sBaseUrl</span> <span class="o">=</span> <span class="s1">&#39;http://www.wasdi.net/wasdiwebserver/rest&#39;</span>
<span class="n">m_bIsOnServer</span> <span class="o">=</span> <span class="bp">False</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <pre><code>Prints status
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">printStatus</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>
    <span class="k">global</span> <span class="n">m_sParametersFilePath</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>
    <span class="k">global</span> <span class="n">m_sBasePath</span>
    <span class="k">global</span> <span class="n">m_bDownloadActive</span>
    <span class="k">global</span> <span class="n">m_bUploadActive</span>
    <span class="k">global</span> <span class="n">m_bVerbose</span>
    <span class="k">global</span> <span class="n">m_aoParamsDictionary</span>
    <span class="k">global</span> <span class="n">m_sMyProcId</span>
    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_bIsOnServer</span>

    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: user: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getUser</span><span class="p">()))</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: password: ***********&#39;</span><span class="p">)</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: session id: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getSessionId</span><span class="p">()))</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: active workspace: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getActiveWorkspaceId</span><span class="p">()))</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: parameters file path: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getParametersFilePath</span><span class="p">()))</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: base path: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getBasePath</span><span class="p">()))</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: download active: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getDownloadActive</span><span class="p">()))</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: upload active: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getUploadActive</span><span class="p">()))</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: verbose: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getVerbose</span><span class="p">()))</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: param dict: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getParametersDict</span><span class="p">()))</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: proc id: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getProcId</span><span class="p">()))</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: base url: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getBaseUrl</span><span class="p">()))</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: is on server: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">getIsOnServer</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">m_bValidSession</span><span class="p">:</span>
        <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.printStatus: session is valid :-)&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.printStatus: session is not valid :-(&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setVerbose</span><span class="p">(</span><span class="n">bVerbose</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bVerbose</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.setVerbose: passed None, won</span><span class="se">\&#39;</span><span class="s1">t change&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bVerbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.setVerbose: passed non boolean, trying to convert&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bVerbose</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">bVerbose</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.setVerbose: cannot convert argument into boolean, won</span><span class="se">\&#39;</span><span class="s1">t change&#39;</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">global</span> <span class="n">m_bVerbose</span>
    <span class="n">m_bVerbose</span> <span class="o">=</span> <span class="n">bVerbose</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getVerbose</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">m_bVerbose</span>
    <span class="k">return</span> <span class="n">m_bVerbose</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <pre><code>Get the full Params Dictionary
:return: a dictionary containing the parameters
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getParametersDict</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_aoParamsDictionary</span>
    <span class="k">return</span> <span class="n">m_aoParamsDictionary</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <pre><code>Adds a parameter
:param sKey: parameter key
:param oValue: parameter value
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">addParameter</span><span class="p">(</span><span class="n">sKey</span><span class="p">,</span> <span class="n">oValue</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_aoParamsDictionary</span>
    <span class="n">m_aoParamsDictionary</span><span class="p">[</span><span class="n">sKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">oValue</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <pre><code>Gets a parameter using its key
:param sKey: parameter key
:return: parameter value
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getParameter</span><span class="p">(</span><span class="n">sKey</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_aoParamsDictionary</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">m_aoParamsDictionary</span><span class="p">[</span><span class="n">sKey</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <pre><code>Sets the WASDI User
:param sUser: WASDI UserID
:return:
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setUser</span><span class="p">(</span><span class="n">sUser</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sUser</span>
    <span class="n">m_sUser</span> <span class="o">=</span> <span class="n">sUser</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <pre><code>Get the WASDI User
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getUser</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sUser</span>
    <span class="k">return</span> <span class="n">m_sUser</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <pre><code>Set the WASDI Password
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setPassword</span><span class="p">(</span><span class="n">sPassword</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sPassword</span>
    <span class="n">m_sPassword</span> <span class="o">=</span> <span class="n">sPassword</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <pre><code>Get the WASDI Password
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getPassword</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sPassword</span>
    <span class="k">return</span> <span class="n">m_sPassword</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <pre><code>Set the WASDI Session
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setSessionId</span><span class="p">(</span><span class="n">sSessionId</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sSessionId</span>
    <span class="n">m_sSessionId</span> <span class="o">=</span> <span class="n">sSessionId</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setParametersFilePath</span><span class="p">(</span><span class="n">sParamPath</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sParamPath</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.setParametersFilePath: passed None as path, won</span><span class="se">\&#39;</span><span class="s1">t change&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sParamPath</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.setParametersFilePath: string passed has zero length, won</span><span class="se">\&#39;</span><span class="s1">t change&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">global</span> <span class="n">m_sParametersFilePath</span>
    <span class="n">m_sParametersFilePath</span> <span class="o">=</span> <span class="n">sParamPath</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getParametersFilePath</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">m_sParametersFilePath</span>
    <span class="k">return</span> <span class="n">m_sParametersFilePath</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <pre><code>Get the WASDI Session
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getSessionId</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sSessionId</span>
    <span class="k">return</span> <span class="n">m_sSessionId</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <pre><code>Set the local Base Path for WASDI
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setBasePath</span><span class="p">(</span><span class="n">sBasePath</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBasePath</span>
    <span class="n">m_sBasePath</span> <span class="o">=</span> <span class="n">sBasePath</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <pre><code>Get the local Base Path for WASDI
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getBasePath</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBasePath</span>
    <span class="k">return</span> <span class="n">m_sBasePath</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <pre><code>Set the WASDI API URL
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setBaseUrl</span><span class="p">(</span><span class="n">sBaseUrl</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="n">m_sBaseUrl</span> <span class="o">=</span> <span class="n">sBaseUrl</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <pre><code>Get the WASDI API URL
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getBaseUrl</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">return</span> <span class="n">m_sBaseUrl</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <pre><code>Set the Is on Server Flag: keep it false, as default, while developing
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setIsOnServer</span><span class="p">(</span><span class="n">bIsOnServer</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_bIsOnServer</span>
    <span class="n">m_bIsOnServer</span> <span class="o">=</span> <span class="n">bIsOnServer</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <pre><code>Get the WASDI API URL
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getIsOnServer</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_bIsOnServer</span>
    <span class="k">return</span> <span class="n">m_bIsOnServer</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <pre><code>When in development, set True to download locally files from Server.
Set it to false to NOT donwload data. In this case the developer must check the availability of the files
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setDownloadActive</span><span class="p">(</span><span class="n">bDownloadActive</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">bDownloadActive</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.setDownloadActive: passed None, won</span><span class="se">\&#39;</span><span class="s1">t change&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">global</span> <span class="n">m_bDownloadActive</span>
    <span class="n">m_bDownloadActive</span> <span class="o">=</span> <span class="n">bDownloadActive</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <pre><code>Get the WASDI API URL
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getDownloadActive</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_bDownloadActive</span>
    <span class="k">return</span> <span class="n">m_bDownloadActive</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <pre><code>When in development, set True to upload local files on Server.
Set it to false to NOT upload data. In this case the developer must check the availability of the files
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setUploadActive</span><span class="p">(</span><span class="n">bUploadActive</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">bUploadActive</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.setUploadActive: passed None, won</span><span class="se">\&#39;</span><span class="s1">t change&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">global</span> <span class="n">m_bUploadActive</span>
    <span class="n">m_bUploadActive</span> <span class="o">=</span> <span class="n">bUploadActive</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <pre><code>Get the WASDI API URL
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getUploadActive</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_bUploadActive</span>
    <span class="k">return</span> <span class="n">m_bUploadActive</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <pre><code>Own Proc Id
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setProcId</span><span class="p">(</span><span class="n">sProcID</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sMyProcId</span>
    <span class="n">m_sMyProcId</span> <span class="o">=</span> <span class="n">sProcID</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      <pre><code>Get the Own Proc Id
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getProcId</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-48'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-48'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sMyProcId</span>
    <span class="k">return</span> <span class="n">m_sMyProcId</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-49'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-49'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">_log</span><span class="p">(</span><span class="n">sLog</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">m_bVerbose</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">sLog</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-50'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-50'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">_getStandardHeaders</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>
    <span class="n">asHeaders</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span> <span class="s1">&#39;x-session-token&#39;</span><span class="p">:</span> <span class="n">m_sSessionId</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">asHeaders</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-51'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-51'>#</a>
      </div>
      <pre><code>Loads configuration from given file
:param sConfigFilePath: a string containing a path to the configuration file
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">_loadConfig</span><span class="p">(</span><span class="n">sConfigFilePath</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-52'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-52'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">sConfigFilePath</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._loadConfigParams: config parameter file name is None, cannot load config&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">sConfigFilePath</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._loadConfigParams: config parameter file name is empty, cannot load config&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">sConfigFilePath</span> <span class="o">=</span> <span class="n">_normPath</span><span class="p">(</span><span class="n">sConfigFilePath</span><span class="p">)</span>

    <span class="k">global</span> <span class="n">m_sUser</span>
    <span class="k">global</span> <span class="n">m_sPassword</span>
    <span class="k">global</span> <span class="n">m_sParametersFilePath</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>
    <span class="k">global</span> <span class="n">m_sBasePath</span>

    <span class="k">global</span> <span class="n">m_bDownloadActive</span>
    <span class="k">global</span> <span class="n">m_bUploadActive</span>
    <span class="k">global</span> <span class="n">m_bVerbose</span>

    <span class="k">try</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-53'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-53'>#</a>
      </div>
      <p>assume it is a JSON file</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">sTempWorkspaceName</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">sTempWorkspaceID</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sConfigFilePath</span><span class="p">)</span> <span class="k">as</span> <span class="n">oJsonFile</span><span class="p">:</span>
            <span class="n">oJson</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">oJsonFile</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;USER&quot;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">:</span>
                <span class="n">m_sUser</span> <span class="o">=</span> <span class="n">oJson</span><span class="p">[</span><span class="s2">&quot;USER&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;PASSWORD&quot;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">:</span>
                <span class="n">m_sPassword</span> <span class="o">=</span> <span class="n">oJson</span><span class="p">[</span><span class="s2">&quot;PASSWORD&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;WORKSPACE&quot;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">:</span>
                <span class="n">sTempWorkspaceName</span> <span class="o">=</span> <span class="n">oJson</span><span class="p">[</span><span class="s2">&quot;WORKSPACE&quot;</span><span class="p">]</span>
                <span class="n">sTempWorkspaceID</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">elif</span> <span class="s2">&quot;WORKSPACEID&quot;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">:</span>
                <span class="n">sTempWorkspaceID</span> <span class="o">=</span> <span class="n">oJson</span><span class="p">[</span><span class="s2">&quot;WORKSPACEID&quot;</span><span class="p">]</span>
                <span class="n">sTempWorkspaceName</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">if</span> <span class="s2">&quot;BASEPATH&quot;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">:</span>
                <span class="n">m_sBasePath</span> <span class="o">=</span> <span class="n">oJson</span><span class="p">[</span><span class="s2">&quot;BASEPATH&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;PARAMETERSFILEPATH&quot;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">:</span>
                <span class="n">m_sParametersFilePath</span> <span class="o">=</span> <span class="n">oJson</span><span class="p">[</span><span class="s2">&quot;PARAMETERSFILEPATH&quot;</span><span class="p">]</span>
                <span class="n">m_sParametersFilePath</span> <span class="o">=</span> <span class="n">_normPath</span><span class="p">(</span><span class="n">m_sParametersFilePath</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;DOWNLOADACTIVE&quot;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">:</span>
                <span class="n">m_bDownloadActive</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">oJson</span><span class="p">[</span><span class="s2">&quot;DOWNLOADACTIVE&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;UPLOADACTIVE&quot;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">:</span>
                <span class="n">m_bUploadActive</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">oJson</span><span class="p">[</span><span class="s2">&quot;UPLOADACTIVE&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;VERBOSE&quot;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">:</span>
                <span class="n">m_bVerbose</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">oJson</span><span class="p">[</span><span class="s2">&quot;VERBOSE&quot;</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">True</span><span class="p">,</span> <span class="n">sTempWorkspaceName</span><span class="p">,</span> <span class="n">sTempWorkspaceID</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">oEx</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._loadConfigParams: something went wrong&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-54'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-54'>#</a>
      </div>
      <pre><code>Loads parameters from file, if specified in configuration file
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">_loadParams</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-55'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-55'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sParametersFilePath</span>
    <span class="k">global</span> <span class="n">m_aoParamsDictionary</span>

    <span class="n">bParamLoaded</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">m_sParametersFilePath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m_sParametersFilePath</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">m_sParametersFilePath</span><span class="p">)</span> <span class="k">as</span> <span class="n">oJsonFile</span><span class="p">:</span>
                <span class="n">m_aoParamsDictionary</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">oJsonFile</span><span class="p">)</span>
                <span class="n">bParamLoaded</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">bParamLoaded</span><span class="p">:</span>
        <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] wasdi could not load param file. That is fine, you can still load it later, don</span><span class="se">\&#39;</span><span class="s1">t worry&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-56'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-56'>#</a>
      </div>
      <pre><code>Refresh parameters, reading the file again
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">refreshParameters</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-57'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-57'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">_loadParams</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-58'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-58'>#</a>
      </div>
      <pre><code>Init WASDI Library. Call it after setting user, password, path and url or use it with a config file
Return True if login was successful, False otherwise
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="n">sConfigFilePath</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-59'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-59'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sUser</span>
    <span class="k">global</span> <span class="n">m_sPassword</span>
    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>
    <span class="k">global</span> <span class="n">m_sBasePath</span>
    <span class="k">global</span> <span class="n">m_bValidSession</span>

    <span class="n">sWname</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">sWId</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">m_bValidSession</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">sConfigFilePath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bConfigOk</span><span class="p">,</span> <span class="n">sWname</span><span class="p">,</span> <span class="n">sWId</span> <span class="o">=</span> <span class="n">_loadConfig</span><span class="p">(</span><span class="n">sConfigFilePath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bConfigOk</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">_loadParams</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">m_sUser</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.init: must initialize user first, but None given&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">if</span> <span class="n">m_sBasePath</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m_bIsOnServer</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">m_sBasePath</span> <span class="o">=</span> <span class="s1">&#39;/data/wasdi/&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sHome</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-60'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-60'>#</a>
      </div>
      <p>the empty string at the end adds a separator</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">m_sBasePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sHome</span><span class="p">,</span> <span class="s2">&quot;.wasdi&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">m_sSessionId</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
        <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/auth/checksession&#39;</span>
        <span class="n">oResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">oResponse</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
            <span class="n">oJsonResult</span> <span class="o">=</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">sUser</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">oJsonResult</span><span class="p">[</span><span class="s1">&#39;userId&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">sUser</span> <span class="o">==</span> <span class="n">m_sUser</span><span class="p">:</span>
                    <span class="n">m_bValidSession</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">m_bValidSession</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">m_bValidSession</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m_bValidSession</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m_sPassword</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.init: must initialize password first, but None given&#39;</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="n">asHeaders</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">}</span>
        <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/auth/login&#39;</span>
        <span class="n">sPayload</span> <span class="o">=</span> <span class="s1">&#39;{&quot;userId&quot;:&quot;&#39;</span> <span class="o">+</span> <span class="n">m_sUser</span> <span class="o">+</span> <span class="s1">&#39;&quot;,&quot;userPassword&quot;:&quot;&#39;</span> <span class="o">+</span> <span class="n">m_sPassword</span> <span class="o">+</span> <span class="s1">&#39;&quot; }&#39;</span>
        <span class="n">oResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">sPayload</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">oResponse</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.init: cannot authenticate&#39;</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
            <span class="n">m_bValidSession</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">elif</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.init: cannot authenticate, server replied: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
            <span class="n">m_bValidSession</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">oJsonResult</span> <span class="o">=</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">m_sSessionId</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">oJsonResult</span><span class="p">[</span><span class="s1">&#39;sessionId&#39;</span><span class="p">])</span>
                <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.init: returned session is: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m_sSessionId</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">m_sSessionId</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">m_sSessionId</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">m_sSessionId</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
                    <span class="n">m_bValidSession</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">m_bValidSession</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">m_bValidSession</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">if</span> <span class="n">m_bValidSession</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.init: WASPY successfully initiated :-)&#39;</span><span class="p">)</span>
        <span class="n">sW</span> <span class="o">=</span> <span class="n">getActiveWorkspaceId</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">sW</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sW</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">sWname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">openWorkspace</span><span class="p">(</span><span class="n">sWname</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sWId</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">openWorkspaceById</span><span class="p">(</span><span class="n">sWId</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.init: could not init WASPY :-(&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>

    <span class="n">printStatus</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">m_bValidSession</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-61'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-61'>#</a>
      </div>
      <pre><code>Hello Wasdi to test the connection.
:return: the hello message as Text
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">hello</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-62'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-62'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBaseUrl</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/wasdi/hello&#39;</span>
    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">oResult</span><span class="o">.</span><span class="n">text</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-63'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-63'>#</a>
      </div>
      <pre><code>Get List of user workspaces
:return: an array of WASDI Workspace JSON Objects.
Each Object is like this
{
</code></pre>
<p>&ldquo;ownerUserId&rdquo;:STRING,
   &ldquo;sharedUsers&rdquo;:[STRING],
   &ldquo;workspaceId&rdquo;:STRING,
   &ldquo;workspaceName&rdquo;:STRING
    }</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getWorkspaces</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-64'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-64'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/ws/byuser&#39;</span>

    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">oResult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
        <span class="n">oJsonResult</span> <span class="o">=</span> <span class="n">oResult</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">oJsonResult</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-65'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-65'>#</a>
      </div>
      <pre><code>Get Id of a Workspace from the name
Return the WorkspaceId as a String, '' if there is any error
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getWorkspaceIdByName</span><span class="p">(</span><span class="n">sName</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-66'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-66'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/ws/byuser&#39;</span>

    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">oResult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
        <span class="n">oJsonResult</span> <span class="o">=</span> <span class="n">oResult</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">oWorkspace</span> <span class="ow">in</span> <span class="n">oJsonResult</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">oWorkspace</span><span class="p">[</span><span class="s1">&#39;workspaceName&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">sName</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">oWorkspace</span><span class="p">[</span><span class="s1">&#39;workspaceId&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">return</span> <span class="s1">&#39;&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-67'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-67'>#</a>
      </div>
      <pre><code>Open a workspace by Id
return the WorkspaceId as a String, '' if there is any error
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">openWorkspaceById</span><span class="p">(</span><span class="n">sWorkspaceId</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-68'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-68'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>
    <span class="n">m_sActiveWorkspace</span> <span class="o">=</span> <span class="n">sWorkspaceId</span>
    <span class="k">return</span> <span class="n">m_sActiveWorkspace</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-69'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-69'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setActiveWorkspaceId</span><span class="p">(</span><span class="n">sActiveWorkspace</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>
    <span class="n">m_sActiveWorkspace</span> <span class="o">=</span> <span class="n">sActiveWorkspace</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-70'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-70'>#</a>
      </div>
      <pre><code>Get Active workspace Id
return the WorkspaceId as a String, '' if there is any error
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getActiveWorkspaceId</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-71'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-71'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>
    <span class="k">return</span> <span class="n">m_sActiveWorkspace</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-72'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-72'>#</a>
      </div>
      <pre><code>Open a workspace
return the WorkspaceId as a String, '' if there is any error
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">openWorkspace</span><span class="p">(</span><span class="n">sWorkspaceName</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-73'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-73'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>
    <span class="n">m_sActiveWorkspace</span> <span class="o">=</span> <span class="n">getWorkspaceIdByName</span><span class="p">(</span><span class="n">sWorkspaceName</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m_sActiveWorkspace</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-74'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-74'>#</a>
      </div>
      <pre><code>Get the list of products in a workspace
the list is an array of string. Can be empty if there is any error
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getProductsByWorkspace</span><span class="p">(</span><span class="n">sWorkspaceName</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-75'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-75'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">sWorkspaceId</span> <span class="o">=</span> <span class="n">getWorkspaceIdByName</span><span class="p">(</span><span class="n">sWorkspaceName</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">getProductsByWorkspaceId</span><span class="p">(</span><span class="n">sWorkspaceId</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-76'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-76'>#</a>
      </div>
      <pre><code>Get the list of products in a workspace (by Id)
the list is an array of string. Can be empty if there is any error
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getProductsByWorkspaceId</span><span class="p">(</span><span class="n">sWorkspaceId</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-77'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-77'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>

    <span class="n">m_sActiveWorkspace</span> <span class="o">=</span> <span class="n">sWorkspaceId</span>
    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sWorkspaceId&#39;</span><span class="p">:</span> <span class="n">sWorkspaceId</span><span class="p">}</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/product/byws&#39;</span>

    <span class="n">asProducts</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">oJsonResults</span> <span class="o">=</span> <span class="n">oResult</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">oProduct</span> <span class="ow">in</span> <span class="n">oJsonResults</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">asProducts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oProduct</span><span class="p">[</span><span class="s1">&#39;fileName&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">continue</span>

    <span class="k">return</span> <span class="n">asProducts</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-78'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-78'>#</a>
      </div>
      <pre><code>Get the list of products in a workspace
the list is an array of string. Can be empty if there is any error
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getProductsByActiveWorkspace</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-79'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-79'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>

    <span class="k">return</span> <span class="n">getProductsByWorkspaceId</span><span class="p">(</span><span class="n">m_sActiveWorkspace</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-80'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-80'>#</a>
      </div>
      <pre><code>Get the full local path of a product given the product name.
Use the output of this API to open the file
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getFullProductPath</span><span class="p">(</span><span class="n">sProductName</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-81'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-81'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBasePath</span>
    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>
    <span class="k">global</span> <span class="n">m_sUser</span>
    <span class="k">global</span> <span class="n">m_bIsOnServer</span>
    <span class="k">global</span> <span class="n">m_bDownloadActive</span>

    <span class="k">if</span> <span class="n">m_bIsOnServer</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">sFullPath</span> <span class="o">=</span> <span class="s1">&#39;/data/wasdi/&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sFullPath</span> <span class="o">=</span> <span class="n">m_sBasePath</span>

    <span class="n">sFullPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sFullPath</span><span class="p">,</span> <span class="n">m_sUser</span><span class="p">,</span> <span class="n">m_sActiveWorkspace</span><span class="p">,</span> <span class="n">sProductName</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">m_bIsOnServer</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m_bDownloadActive</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">sFullPath</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-82'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-82'>#</a>
      </div>
      <p>Download The File from WASDI</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.getFullProductPath: LOCAL WASDI FILE MISSING: START DOWNLOAD... PLEASE WAIT&#39;</span><span class="p">)</span>
                <span class="n">downloadFile</span><span class="p">(</span><span class="n">sProductName</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sFullPath</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-83'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-83'>#</a>
      </div>
      <pre><code>Get the local base save path for a product. To save use this path + fileName. Path already include '/' as last char
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getSavePath</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-84'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-84'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBasePath</span>
    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>
    <span class="k">global</span> <span class="n">m_sUser</span>

    <span class="k">if</span> <span class="n">m_bIsOnServer</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">sFullPath</span> <span class="o">=</span> <span class="s1">&#39;/data/wasdi/&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sFullPath</span> <span class="o">=</span> <span class="n">m_sBasePath</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-85'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-85'>#</a>
      </div>
      <p>empty string at the ends adds a final separator</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">sFullPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sFullPath</span><span class="p">,</span> <span class="n">m_sUser</span><span class="p">,</span> <span class="n">m_sActiveWorkspace</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sFullPath</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-86'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-86'>#</a>
      </div>
      <p>Get the list of workflows for the user
   Return None if there is any error
   Return an array of WASDI Workspace JSON Objects if everything is ok, None otherwise. The format is as follows:</p>
<p>{
       &ldquo;description&rdquo;:STRING,
       &ldquo;name&rdquo;: STRING,
       &ldquo;workflowId&rdquo;: STRING
   }</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getWorkflows</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-87'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-87'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/processing/getgraphsbyusr&#39;</span>

    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">oResult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
        <span class="n">oJsonResults</span> <span class="o">=</span> <span class="n">oResult</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">oJsonResults</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-88'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-88'>#</a>
      </div>
      <pre><code>get the status of a Process
return the status or '' if there was any error

STATUS are  CREATED,  RUNNING,  STOPPED,  DONE,  ERROR
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getProcessStatus</span><span class="p">(</span><span class="n">sProcessId</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-89'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-89'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sProcessId&#39;</span><span class="p">:</span> <span class="n">sProcessId</span><span class="p">}</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/process/byid&#39;</span>

    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>

    <span class="n">sStatus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">oResult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
        <span class="n">oJsonResult</span> <span class="o">=</span> <span class="n">oResult</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">sStatus</span> <span class="o">=</span> <span class="n">oJsonResult</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sStatus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">return</span> <span class="n">sStatus</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-90'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-90'>#</a>
      </div>
      <pre><code>Update the status of a process
return the updated status as a String or '' if there was any problem
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">updateProcessStatus</span><span class="p">(</span><span class="n">sProcessId</span><span class="p">,</span> <span class="n">sStatus</span><span class="p">,</span> <span class="n">iPerc</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-91'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-91'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">sProcessId</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.updateProcessStatus: cannot update status, process ID is None&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">sStatus</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.updateProcessStatus: cannot update status, status is None&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">iPerc</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.updateProcessStatus: percentage is None&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="n">iPerc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.updateProcessStatus: iPerc &lt; 0 not valid&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="n">iPerc</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.updateProcessStatus: iPerc &gt; 100 not valid&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="n">sStatus</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;CREATED&#39;</span><span class="p">,</span> <span class="s1">&#39;RUNNING&#39;</span><span class="p">,</span> <span class="s1">&#39;STOPPED&#39;</span><span class="p">,</span> <span class="s1">&#39;DONE&#39;</span><span class="p">,</span> <span class="s1">&#39;ERROR&#39;</span><span class="p">}:</span>
        <span class="k">print</span><span class="p">(</span>
            <span class="s1">&#39;[ERROR] waspy.updateProcessStatus: sStatus must be a string in: &#39;</span> <span class="o">+</span>
            <span class="s1">&#39;{CREATED,  RUNNING,  STOPPED,  DONE,  ERROR&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="n">sProcessId</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sProcessId&#39;</span><span class="p">:</span> <span class="n">sProcessId</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="n">sStatus</span><span class="p">,</span> <span class="s1">&#39;perc&#39;</span><span class="p">:</span> <span class="n">iPerc</span><span class="p">}</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/process/updatebyid&#39;</span>

    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>

    <span class="n">sStatus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">oResult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
        <span class="n">oJsonResult</span> <span class="o">=</span> <span class="n">oResult</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sStatus</span> <span class="o">=</span> <span class="n">oJsonResult</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sStatus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">return</span> <span class="n">sStatus</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-92'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-92'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">updateProgressPerc</span><span class="p">(</span><span class="n">iPerc</span><span class="p">):</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.updateProgressPerc( &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iPerc</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; )&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">iPerc</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.updateProgressPerc: Passed None, expected a percentage&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">getProcId</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">getProcId</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.updateProgressPerc: Cannot update progress: process ID is not known&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="mi">0</span> <span class="o">&gt;</span> <span class="n">iPerc</span> <span class="ow">or</span> <span class="mi">100</span> <span class="o">&lt;</span> <span class="n">iPerc</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[WARNING] waspy.updateProgressPerc: passed&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iPerc</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, automatically resetting in [0, 100]&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">iPerc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">iPerc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">iPerc</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">iPerc</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="n">sStatus</span> <span class="o">=</span> <span class="s2">&quot;RUNNING&quot;</span>
    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">getBaseUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;/process/updatebyid?sProcessId=&quot;</span> <span class="o">+</span> <span class="n">getProcId</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&amp;status=&quot;</span> <span class="o">+</span> <span class="n">sStatus</span> <span class="o">+</span> <span class="s2">&quot;&amp;perc=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
        <span class="n">iPerc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&amp;sendrabbit=1&quot;</span>
    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">oResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>
    <span class="n">sResult</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">oResponse</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
        <span class="n">oJson</span> <span class="o">=</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">oJson</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;status&quot;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">):</span>
            <span class="n">sResult</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">oJson</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.updateProgressPerc: could not update progress&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sResult</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-93'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-93'>#</a>
      </div>
      <pre><code>Update the status of a process
return the updated status as a String or '' if there was any problem
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">setProcessPayload</span><span class="p">(</span><span class="n">sProcessId</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-94'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-94'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sProcessId&#39;</span><span class="p">:</span> <span class="n">sProcessId</span><span class="p">,</span> <span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)}</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/process/setpayload&#39;</span>

    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>

    <span class="n">sStatus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">oResult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
        <span class="n">oJsonResult</span> <span class="o">=</span> <span class="n">oResult</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sStatus</span> <span class="o">=</span> <span class="n">oJsonResult</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sStatus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">return</span> <span class="n">sStatus</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-95'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-95'>#</a>
      </div>
      <pre><code>Ingest a new file in the Active WASDI Workspace.
The method takes a file saved in the workspace root (see getSaveFilePath) not already added to the WS
To work be sure that the file is on the server
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">saveFile</span><span class="p">(</span><span class="n">sFileName</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-96'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-96'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>
    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="n">sFileName</span><span class="p">,</span> <span class="s1">&#39;workspace&#39;</span><span class="p">:</span> <span class="n">m_sActiveWorkspace</span><span class="p">}</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/catalog/upload/ingestinws&#39;</span>

    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>

    <span class="n">sProcessId</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">oResult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
        <span class="n">oJsonResult</span> <span class="o">=</span> <span class="n">oResult</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">oJsonResult</span><span class="p">[</span><span class="s1">&#39;boolValue&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">sProcessId</span> <span class="o">=</span> <span class="n">oJsonResult</span><span class="p">[</span><span class="s1">&#39;stringValue&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sProcessId</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">return</span> <span class="n">sProcessId</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-97'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-97'>#</a>
      </div>
      <pre><code>Ingest a new file in the Active WASDI Workspace.
The method takes a file saved in the workspace root (see getSaveFilePath) not already added to the WS
To work be sure that the file is on the server
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">downloadFile</span><span class="p">(</span><span class="n">sFileName</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-98'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-98'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.downloadFile( &#39;</span> <span class="o">+</span> <span class="n">sFileName</span> <span class="o">+</span> <span class="s1">&#39; )&#39;</span><span class="p">)</span>

    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>
    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">sFileName</span><span class="p">}</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="s1">&#39;/catalog/downloadbyname?&#39;</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="s1">&#39;filename=&#39;</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="n">sFileName</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="s2">&quot;&amp;workspace=&quot;</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="n">getActiveWorkspaceId</span><span class="p">()</span>

    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.downloadfile: send request to configured url &#39;</span> <span class="o">+</span> <span class="n">sUrl</span><span class="p">)</span>

    <span class="n">oResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">oResponse</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">):</span>
        <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.downloadFile: got ok result, downloading&#39;</span><span class="p">)</span>
        <span class="n">sAttachmentName</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">asResponseHeaders</span> <span class="o">=</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">headers</span>
        <span class="k">if</span> <span class="n">asResponseHeaders</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Content-Disposition&#39;</span> <span class="ow">in</span> <span class="n">asResponseHeaders</span><span class="p">:</span>
                <span class="n">sContentDisposition</span> <span class="o">=</span> <span class="n">asResponseHeaders</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span>
                <span class="n">sAttachmentName</span> <span class="o">=</span> <span class="n">sContentDisposition</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;filename=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">bLoop</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">while</span> <span class="n">bLoop</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sAttachmentName</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
                        <span class="n">sAttachmentName</span> <span class="o">=</span> <span class="n">sAttachmentName</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                        <span class="n">bLoop</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">bLoop</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">sAttachmentName</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">sAttachmentName</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">):</span>
                        <span class="n">sAttachmentName</span> <span class="o">=</span> <span class="n">sAttachmentName</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                        <span class="n">bLoop</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">bLoop</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">sAttachmentName</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">sAttachmentName</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">):</span>
                        <span class="n">sAttachmentName</span> <span class="o">=</span> <span class="n">sAttachmentName</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">bLoop</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">bLoop</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">sAttachmentName</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">sAttachmentName</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">):</span>
                        <span class="n">sAttachmentName</span> <span class="o">=</span> <span class="n">sAttachmentName</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                        <span class="n">bLoop</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">bLoop</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">sAttachmentName</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">sAttachmentName</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">):</span>
                        <span class="n">sAttachmentName</span> <span class="o">=</span> <span class="n">sAttachmentName</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">bLoop</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">bLoop</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">sSavePath</span> <span class="o">=</span> <span class="n">getSavePath</span><span class="p">()</span>
        <span class="n">sSavePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sSavePath</span><span class="p">,</span> <span class="n">sAttachmentName</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sSavePath</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># Guard against race condition</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.downloadFile: cannot create File Path, aborting&#39;</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.downloadFile: downloading local file &#39;</span> <span class="o">+</span> <span class="n">sSavePath</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sSavePath</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">oFile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">oChunk</span> <span class="ow">in</span> <span class="n">oResponse</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-99'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-99'>#</a>
      </div>
      <p>_log(&lsquo;.&rsquo;)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="n">oFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">oChunk</span><span class="p">)</span>
        <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.downloadFile: download done, new file locally available &#39;</span> <span class="o">+</span> <span class="n">sSavePath</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">sAttachmentName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="p">(</span><span class="n">sAttachmentName</span> <span class="o">!=</span> <span class="n">sFileName</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="n">sAttachmentName</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.zip&#39;</span><span class="p">):</span>
            <span class="n">sPath</span> <span class="o">=</span> <span class="n">getSavePath</span><span class="p">()</span>
            <span class="n">_unzip</span><span class="p">(</span><span class="n">sAttachmentName</span><span class="p">,</span> <span class="n">sPath</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.downloadFile: download error, server code: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>

    <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-100'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-100'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">wasdiLog</span><span class="p">(</span><span class="n">sLogRow</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>
    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>

    <span class="k">if</span> <span class="n">m_bIsOnServer</span><span class="p">:</span>
        <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
        <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/processors/logs/add?processworkspace=&#39;</span> <span class="o">+</span> <span class="n">m_sMyProcId</span>
        <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">sLogRow</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">oResult</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[WARNING] waspy.wasdiLog: could not log&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[WARNING] waspy.wasdiLog: could not log, server returned: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oResult</span><span class="o">.</span><span class="n">status_code</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_log</span><span class="p">(</span><span class="n">sLogRow</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-101'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-101'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">deleteProduct</span><span class="p">(</span><span class="n">sProduct</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>
    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>

    <span class="k">if</span> <span class="n">sProduct</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.deleteProduct: product passed is None&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span>
    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="s2">&quot;/product/delete?sProductName=&quot;</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="n">sProduct</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="s2">&quot;&amp;bDeleteFile=true&amp;sWorkspaceId=&quot;</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="n">m_sActiveWorkspace</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="s2">&quot;&amp;bDeleteLayer=true&quot;</span>
    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">oResult</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.deleteProduct: deletion failed&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">elif</span> <span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.deleteProduct: deletion failed, server returned: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oResult</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">oResult</span><span class="o">.</span><span class="n">ok</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-102'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-102'>#</a>
      </div>
      <pre><code>Search EO images

:param sPlatform: satellite platform (S1 or S2)
:param sDateFrom: inital date YYYY-MM-DD
:param sDateTo: final date YYYY-MM-DD
:param fULLat: Latitude of Upper-Left corner
:param fULLon: Longitude of Upper-Left corner
:param fLRLat: Latitude of Lower-Right corner
:param fLRLon: Longitude of Lower-Right corner
:param sProductType: type of EO product
:param iOrbitNumber: orbit number
:param sSensorOperationalMode: sensor operational mode
:param sCloudCoverage: interval of allowed cloud coverage, e.g. "[0 TO 22.5]"
:return: a list of results
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">searchEOImages</span><span class="p">(</span><span class="n">sPlatform</span><span class="p">,</span> <span class="n">sDateFrom</span><span class="p">,</span> <span class="n">sDateTo</span><span class="p">,</span>
                   <span class="n">fULLat</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fULLon</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fLRLat</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fLRLon</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">sProductType</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">iOrbitNumber</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">sSensorOperationalMode</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sCloudCoverage</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-103'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-103'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">aoReturnList</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">sPlatform</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.searchEOImages: platform cannot be None&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">aoReturnList</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-104'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-104'>#</a>
      </div>
      <p>todo support other platforms</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="n">sPlatform</span> <span class="o">!=</span> <span class="s2">&quot;S1&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sPlatform</span> <span class="o">!=</span> <span class="s2">&quot;S2&quot;</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.searchEOImages: platform must be S1 or S2. Received [&#39;</span> <span class="o">+</span> <span class="n">sPlatform</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">aoReturnList</span>

    <span class="k">if</span> <span class="n">sPlatform</span> <span class="o">==</span> <span class="s2">&quot;S1&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sProductType</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">sProductType</span> <span class="o">==</span> <span class="s2">&quot;SLC&quot;</span> <span class="ow">or</span> <span class="n">sProductType</span> <span class="o">==</span> <span class="s2">&quot;GRD&quot;</span> <span class="ow">or</span> <span class="n">sProductType</span> <span class="o">==</span> <span class="s2">&quot;OCN&quot;</span><span class="p">):</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[ERROR] waspy.searchEOImages: Available Product Types for S1; SLC, GRD, OCN. Received [&quot;</span> <span class="o">+</span>
                      <span class="n">sProductType</span> <span class="o">+</span>
                      <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">aoReturnList</span>

    <span class="k">if</span> <span class="n">sPlatform</span> <span class="o">==</span> <span class="s2">&quot;S2&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sProductType</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">sProductType</span> <span class="o">==</span> <span class="s2">&quot;S2MSI1C&quot;</span> <span class="ow">or</span> <span class="n">sProductType</span> <span class="o">==</span> <span class="s2">&quot;S2MSI2Ap&quot;</span> <span class="ow">or</span> <span class="n">sProductType</span> <span class="o">==</span> <span class="s2">&quot;S2MSI2A&quot;</span><span class="p">):</span>
                <span class="k">print</span><span class="p">(</span>
                    <span class="s2">&quot;[ERROR] waspy.searchEOImages: Available Product Types for S2; S2MSI1C, S2MSI2Ap, S2MSI2A. Received [&quot;</span>
                    <span class="o">+</span> <span class="n">sProductType</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span> <span class="o">+</span>
                    <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">aoReturnList</span>

    <span class="k">if</span> <span class="n">sDateFrom</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[ERROR] waspy.searchEOImages: sDateFrom cannot be None&quot;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">aoReturnList</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-105'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-105'>#</a>
      </div>
      <p>if (len(sDateFrom) &lt; 10) or (sDateFrom[4] != &lsquo;-&lsquo;) or (sDateFrom[7] != &lsquo;-&lsquo;):</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\d\d\d\d\-\d\d\-\d\d&quot;</span><span class="p">,</span> <span class="n">sDateFrom</span><span class="p">)):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[ERROR] waspy.searchEOImages: sDateFrom must be in format YYYY-MM-DD&quot;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">aoReturnList</span>

    <span class="k">if</span> <span class="n">sDateTo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[ERROR] waspy.searchEOImages: sDateTo cannot be None&quot;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">aoReturnList</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-106'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-106'>#</a>
      </div>
      <p>if len(sDateTo) &lt; 10 or sDateTo[4] != &lsquo;-&lsquo; or sDateTo[7] != &lsquo;-&lsquo;:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\d\d\d\d\-\d\d\-\d\d&quot;</span><span class="p">,</span> <span class="n">sDateTo</span><span class="p">)):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[ERROR] waspy.searchEOImages: sDateTo must be in format YYYY-MM-DD&quot;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">aoReturnList</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-107'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-107'>#</a>
      </div>
      <p>create query string:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-108'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-108'>#</a>
      </div>
      <p>platform name</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">sQuery</span> <span class="o">=</span> <span class="s2">&quot;( platformname:&quot;</span>
    <span class="k">if</span> <span class="n">sPlatform</span> <span class="o">==</span> <span class="s2">&quot;S2&quot;</span><span class="p">:</span>
        <span class="n">sQuery</span> <span class="o">+=</span> <span class="s2">&quot;Sentinel-2 &quot;</span>
    <span class="k">elif</span> <span class="n">sPlatform</span> <span class="o">==</span> <span class="s2">&quot;S1&quot;</span><span class="p">:</span>
        <span class="n">sQuery</span> <span class="o">+=</span> <span class="s2">&quot;Sentinel-1&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-109'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-109'>#</a>
      </div>
      <p>If available add product type</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">sProductType</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">sQuery</span> <span class="o">+=</span> <span class="s2">&quot; AND producttype:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sProductType</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-110'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-110'>#</a>
      </div>
      <p>If available Sensor Operational Mode</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="n">sSensorOperationalMode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sPlatform</span> <span class="o">==</span> <span class="s2">&quot;S1&quot;</span><span class="p">):</span>
        <span class="n">sQuery</span> <span class="o">+=</span> <span class="s2">&quot; AND sensoroperationalmode:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sSensorOperationalMode</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-111'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-111'>#</a>
      </div>
      <p>If available cloud coverage</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="n">sCloudCoverage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sCloudCoverage</span> <span class="o">==</span> <span class="s2">&quot;S2&quot;</span><span class="p">):</span>
        <span class="n">sQuery</span> <span class="o">+=</span> <span class="s2">&quot; AND cloudcoverpercentage:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sCloudCoverage</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-112'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-112'>#</a>
      </div>
      <p>If available add orbit number</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">iOrbitNumber</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iOrbitNumber</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">sQuery</span> <span class="o">+=</span> <span class="s2">&quot; AND relativeorbitnumber:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iOrbitNumber</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[WARNING] waspy.searchEOImages: iOrbitNumber is&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iOrbitNumber</span><span class="p">),</span>
                  <span class="s1">&#39;, but it should be an integer&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">iTmp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">iOrbitNumber</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[WARNING] waspy.searchEOImages: iOrbitNumber converted to: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iTmp</span><span class="p">))</span>
                <span class="n">sQuery</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">iTmp</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[WARNING] waspy.searchEOImages: could not convert iOrbitNumber to an int, ignoring it&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-113'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-113'>#</a>
      </div>
      <p>Close the first block</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">sQuery</span> <span class="o">+=</span> <span class="s2">&quot;) &quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-114'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-114'>#</a>
      </div>
      <p>Date Block</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">sQuery</span> <span class="o">+=</span> <span class="s2">&quot;AND ( beginPosition:[&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sDateFrom</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;T00:00:00.000Z TO &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sDateTo</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;T23:59:59.999Z]&quot;</span>
    <span class="n">sQuery</span> <span class="o">+=</span> <span class="s2">&quot;AND ( endPosition:[&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sDateFrom</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;T00:00:00.000Z TO &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sDateTo</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;T23:59:59.999Z]&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-115'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-115'>#</a>
      </div>
      <p>Close the second block</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">sQuery</span> <span class="o">+=</span> <span class="s2">&quot;) &quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-116'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-116'>#</a>
      </div>
      <p>footprint polygon</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="n">fULLat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">fULLon</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">fLRLat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">fLRLon</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">sFootPrint</span> <span class="o">=</span> <span class="s2">&quot;( footprint:</span><span class="se">\&quot;</span><span class="s2">intersects(POLYGON(( &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fULLon</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fLRLat</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> \
                     <span class="nb">str</span><span class="p">(</span><span class="n">fULLon</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fULLat</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fLRLon</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fULLat</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fLRLon</span><span class="p">)</span> <span class="o">+</span> \
                     <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fLRLat</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fULLon</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fLRLat</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)))</span><span class="se">\&quot;</span><span class="s2">) AND &quot;</span>
    <span class="n">sQuery</span> <span class="o">=</span> <span class="n">sFootPrint</span> <span class="o">+</span> <span class="n">sQuery</span>

    <span class="n">sQueryBody</span> <span class="o">=</span> <span class="s2">&quot;[</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">sQuery</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\\&quot;</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">]&quot;</span>
    <span class="n">sQuery</span> <span class="o">=</span> <span class="s2">&quot;sQuery=&quot;</span> <span class="o">+</span> <span class="n">sQuery</span> <span class="o">+</span> <span class="s2">&quot;&amp;offset=0&amp;limit=10&amp;providers=ONDA&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">sUrl</span> <span class="o">=</span> <span class="n">getBaseUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;/search/querylist?&quot;</span> <span class="o">+</span> <span class="n">sQuery</span>
        <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
        <span class="n">oResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">sQueryBody</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-117'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-117'>#</a>
      </div>
      <p>populate list from response</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">oJsonResponse</span> <span class="o">=</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">aoReturnList</span> <span class="o">=</span> <span class="n">oJsonResponse</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">oEx</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.searchEOImages: exception while trying to convert response into JSON object&#39;</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">aoReturnList</span>

        <span class="n">_log</span><span class="p">(</span><span class="s2">&quot;[INFO] waspy.searchEOImages: search results:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">aoReturnList</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">aoReturnList</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">oEx</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.searchEOImages: an error occured&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="n">_log</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">oEx</span><span class="p">))</span>
        <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
        <span class="n">_log</span><span class="p">(</span><span class="n">oEx</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">aoReturnList</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-118'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-118'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">getFoundProductName</span><span class="p">(</span><span class="n">aoProduct</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">aoProduct</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.getFoundProductName: product is None, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="s2">&quot;title&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">aoProduct</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.getFoundProductName: title not found in product, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">aoProduct</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-119'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-119'>#</a>
      </div>
      <pre><code>checks hwther a file already exists on WASDI or not
:param sFileName: file name. Warning: must be the complete path
:return: True if the file exists, False otherwise
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">_fileExistsOnWasdi</span><span class="p">(</span><span class="n">sFileName</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-120'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-120'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">sFileName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._fileExistsOnWasdi: file name must not be None&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sFileName</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._fileExistsOnWasdi: File name too short&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="n">sBaseUrl</span> <span class="o">=</span> <span class="n">getBaseUrl</span><span class="p">()</span>
    <span class="n">sSessionId</span> <span class="o">=</span> <span class="n">getSessionId</span><span class="p">()</span>
    <span class="n">sActiveWorkspace</span> <span class="o">=</span> <span class="n">getActiveWorkspaceId</span><span class="p">()</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="s2">&quot;/catalog/checkdownloadavaialibitybyname?token=&quot;</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="n">sSessionId</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="s2">&quot;&amp;filename=&quot;</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="n">sFileName</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="s2">&quot;&amp;workspace=&quot;</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="n">sActiveWorkspace</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">oResult</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._fileExistsOnWasdi: failed contacting the server&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">elif</span> <span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._fileExistsOnWasdi: failed, server returned: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oResult</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">oResult</span><span class="o">.</span><span class="n">ok</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-121'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-121'>#</a>
      </div>
      <pre><code>Unzips a file
:param sAttachmentName: filename to unzip
:param sPath: both the path where the file is and where it must be unzipped
:return:
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">_unzip</span><span class="p">(</span><span class="n">sAttachmentName</span><span class="p">,</span> <span class="n">sPath</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-122'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-122'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy._unzip( &#39;</span> <span class="o">+</span> <span class="n">sAttachmentName</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">sPath</span> <span class="o">+</span> <span class="s1">&#39; )&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sPath</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._unzip: path is None&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">sAttachmentName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._unzip: attachment to unzip is None&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">sZipFilePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sPath</span><span class="p">,</span> <span class="n">sAttachmentName</span><span class="p">)</span>
        <span class="n">zip_ref</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">sZipFilePath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">sPath</span><span class="p">)</span>
        <span class="n">zip_ref</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._unzip: failed unzipping&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>

    <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-123'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-123'>#</a>
      </div>
      <p>todo split into 2 functions</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">importProduct</span><span class="p">(</span><span class="n">sFileUrl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sBoundingBox</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">asProduct</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-124'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-124'>#</a>
      </div>
      <pre><code>Imports a product from a Provider in WASDI
:param sFileUrl:
:param sBoundingBox:
:return: execution status
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.importProduct( &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sFileUrl</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sBoundingBox</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">asProduct</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; )&#39;</span><span class="p">)</span>

    <span class="n">sReturn</span> <span class="o">=</span> <span class="s2">&quot;ERROR&quot;</span>

    <span class="k">if</span> <span class="n">sFileUrl</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">asProduct</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="s2">&quot;link&quot;</span> <span class="ow">in</span> <span class="n">asProduct</span><span class="p">:</span>
        <span class="n">sFileUrl</span> <span class="o">=</span> <span class="n">asProduct</span><span class="p">[</span><span class="s2">&quot;link&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;footprint&quot;</span> <span class="ow">in</span> <span class="n">asProduct</span><span class="p">:</span>
            <span class="n">sBoundingBox</span> <span class="o">=</span> <span class="n">asProduct</span><span class="p">[</span><span class="s2">&quot;footprint&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">sFileUrl</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.importProduct: cannot find a link to download the requested product&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sReturn</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">getBaseUrl</span><span class="p">()</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="s2">&quot;/filebuffer/download?sFileUrl=&quot;</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="n">sFileUrl</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="s2">&quot;&amp;sProvider=ONDA&amp;sWorkspaceId=&quot;</span>
    <span class="n">sUrl</span> <span class="o">+=</span> <span class="n">getActiveWorkspaceId</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">sBoundingBox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">sUrl</span> <span class="o">+=</span> <span class="s2">&quot;&amp;sBoundingBox=&quot;</span>
        <span class="n">sUrl</span> <span class="o">+=</span> <span class="n">sBoundingBox</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>

    <span class="n">oResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">oResponse</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.importProduct: cannot import product&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.importProduct: cannot import product, server returned: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">oJsonResponse</span> <span class="o">=</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;boolValue&quot;</span> <span class="ow">in</span> <span class="n">oJsonResponse</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oJsonResponse</span><span class="p">[</span><span class="s2">&quot;boolValue&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;stringValue&quot;</span> <span class="ow">in</span> <span class="n">oJsonResponse</span><span class="p">:</span>
                <span class="n">sProcessId</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">oJsonResponse</span><span class="p">[</span><span class="s2">&quot;stringValue&quot;</span><span class="p">])</span>
                <span class="n">sReturn</span> <span class="o">=</span> <span class="n">waitProcess</span><span class="p">(</span><span class="n">sProcessId</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sReturn</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-125'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-125'>#</a>
      </div>
      <pre><code>Execute a WASDI processor asynchronously
:param sProcessorName: WASDI processor name
:param aoParams: a dictionary of parameters for the processor
:return: processor ID
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">asynchExecuteProcessor</span><span class="p">(</span><span class="n">sProcessorName</span><span class="p">,</span> <span class="n">aoParams</span><span class="o">=</span><span class="p">{}):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-126'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-126'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.asynchExecuteProcessor( &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sProcessorName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aoParams</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; )&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sProcessorName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.asynchExecuteProcessor: processor name is None, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sProcessorName</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.asynchExecuteProcessor: processor name empty, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aoParams</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.asynchExecuteProcessor: parameters must be a dictionary but it is not, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">getBaseUrl</span><span class="p">()</span> <span class="o">+</span> \
           <span class="s2">&quot;/processors/run?workspace=&quot;</span> <span class="o">+</span> <span class="n">getActiveWorkspaceId</span><span class="p">()</span> <span class="o">+</span> \
           <span class="s2">&quot;&amp;name=&quot;</span> <span class="o">+</span> <span class="n">sProcessorName</span> <span class="o">+</span> \
           <span class="s2">&quot;&amp;encodedJson=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aoParams</span><span class="p">)</span>
    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">oResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">aoParams</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">oResponse</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.asynchExecuteProcessor: something broke when contacting the server, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.asynchExecuteProcessor: API call OK&#39;</span><span class="p">)</span>
        <span class="n">aoJson</span> <span class="o">=</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;processingIdentifier&quot;</span> <span class="ow">in</span> <span class="n">aoJson</span><span class="p">:</span>
            <span class="n">sProcessID</span> <span class="o">=</span> <span class="n">aoJson</span><span class="p">[</span><span class="s1">&#39;processingIdentifier&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">sProcessID</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.asynchExecuteProcessor: cannot extract processing identifier from response, aborting&#39;</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.asynchExecuteProcessor: server returned status &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s1">&#39;&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-127'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-127'>#</a>
      </div>
      <pre><code>Executes a WASDI Processor
return the Process Id if every thing is ok
return '' if there was any problem
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">executeProcessor</span><span class="p">(</span><span class="n">sProcessorName</span><span class="p">,</span> <span class="n">aoProcessParams</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-128'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-128'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">global</span> <span class="n">m_sBaseUrl</span>
    <span class="k">global</span> <span class="n">m_sSessionId</span>
    <span class="k">global</span> <span class="n">m_sActiveWorkspace</span>

    <span class="n">sEncodedParams</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">aoProcessParams</span><span class="p">)</span>
    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;workspace&#39;</span><span class="p">:</span> <span class="n">m_sActiveWorkspace</span><span class="p">,</span>
               <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">sProcessorName</span><span class="p">,</span>
               <span class="s1">&#39;sProcessorName&#39;</span><span class="p">:</span> <span class="n">sEncodedParams</span><span class="p">}</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s1">&#39;/processors/run&#39;</span>

    <span class="n">oResult</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>

    <span class="n">sProcessId</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">oResult</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oResult</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
        <span class="n">oJsonResults</span> <span class="o">=</span> <span class="n">oResult</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">sProcessId</span> <span class="o">=</span> <span class="n">oJsonResults</span><span class="p">[</span><span class="s1">&#39;processingIdentifier&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sProcessId</span>

    <span class="k">return</span> <span class="n">sProcessId</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-129'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-129'>#</a>
      </div>
      <p>todo extend to a list of processes</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">waitProcess</span><span class="p">(</span><span class="n">sProcessId</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sProcessId</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.waitProcess: Passed None, expected a process ID&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;ERROR&quot;</span>

    <span class="k">if</span> <span class="n">sProcessId</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.waitProcess: Passed empty, expected a process ID&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;ERROR&quot;</span>

    <span class="n">sStatus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">while</span> <span class="n">sStatus</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;DONE&quot;</span><span class="p">,</span> <span class="s2">&quot;STOPPED&quot;</span><span class="p">,</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">}:</span>
        <span class="n">sStatus</span> <span class="o">=</span> <span class="n">getProcessStatus</span><span class="p">(</span><span class="n">sProcessId</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sStatus</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-130'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-130'>#</a>
      </div>
      <pre><code>Uploads a file to WASDI
:param sFileName: name of file inside working directory OR path to file RELATIVE to working directory
:return: True if succeded, False otherwise
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">uploadFile</span><span class="p">(</span><span class="n">sFileName</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-131'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-131'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.upload( &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sFileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; )&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sFileName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.upload: the given file name is None, cannot upload&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">sFileName</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
        <span class="n">sFileName</span> <span class="o">=</span> <span class="n">sFileName</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">if</span> <span class="n">sFileName</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">sFileName</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">):</span>
        <span class="n">sFileName</span> <span class="o">=</span> <span class="n">sFileName</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="n">sFileName</span> <span class="o">=</span> <span class="n">_normPath</span><span class="p">(</span><span class="n">sFileName</span><span class="p">)</span>

    <span class="n">bResult</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="n">sBasePath</span> <span class="o">=</span> <span class="n">getBasePath</span><span class="p">()</span>
    <span class="n">sFullPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sBasePath</span><span class="p">,</span> <span class="n">sFileName</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bResult</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-132'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-132'>#</a>
      </div>
      <pre><code>Normalizes path by adjusting separator
:param sPath: a path to be normalized
:return: the normalized path
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">_normPath</span><span class="p">(</span><span class="n">sPath</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-133'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-133'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">sPath</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._normPath: passed path is None&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">sPath</span> <span class="o">=</span> <span class="n">sPath</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
    <span class="n">sPath</span> <span class="o">=</span> <span class="n">sPath</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sPath</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-134'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-134'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">addFileToWASDI</span><span class="p">(</span><span class="n">sFileName</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_internalAddFileToWASDI</span><span class="p">(</span><span class="n">sFileName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-135'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-135'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">asynchAddFileToWASDI</span><span class="p">(</span><span class="n">sFileName</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_internalAddFileToWASDI</span><span class="p">(</span><span class="n">sFileName</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-136'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-136'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">_internalAddFileToWASDI</span><span class="p">(</span><span class="n">sFileName</span><span class="p">,</span> <span class="n">bAsynch</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy._internalAddFileToWASDI( &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sFileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">bAsynch</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; )&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sFileName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalAddFileToWASDI: file name is None, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sFileName</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[WARNING] waspy._internalAddFileToWASDI: file name is not a string, trying conversion&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sFileName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sFileName</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalAddFileToWASDI: cannot convert file name into string, aborting&#39;</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sFileName</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalAddFileToWASDI: file name has zero length, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="n">bAsynch</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[WARNING] waspy._internalAddFileToWASDI: asynch flag is None, assuming False&#39;</span><span class="p">)</span>
        <span class="n">bAsynch</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bAsynch</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[WARNING] waspy._internalAddFileToWASDI: asynch flag is not a boolean, trying casting&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bAsynch</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">bAsynch</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalAddFileToWASDI: could not convert asynch flag into bool, aborting&#39;</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="n">sResult</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">getUploadActive</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">sFilePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">getSavePath</span><span class="p">(),</span> <span class="n">sFileName</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_fileExistsOnWasdi</span><span class="p">(</span><span class="n">sFilePath</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy._internalAddFileToWASDI: remote file is missing, uploading&#39;</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">uploadFile</span><span class="p">(</span><span class="n">sFileName</span><span class="p">)</span>
                    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy._internalAddFileToWASDI: file uploaded, keep on working!&#39;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalAddFileToWASDI: could not proceed with upload&#39;</span> <span class="o">+</span>
                          <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>

        <span class="n">sUrl</span> <span class="o">=</span> <span class="n">getBaseUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;/catalog/upload/ingestinws?file=&quot;</span> <span class="o">+</span> <span class="n">sFileName</span> <span class="o">+</span> <span class="s2">&quot;&amp;workspace=&quot;</span> <span class="o">+</span> <span class="n">getActiveWorkspaceId</span><span class="p">()</span>
        <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
        <span class="n">oResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">oResponse</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalAddFileToWASDI: cannot contact server&#39;</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalAddFileToWASDI: failed, server replied &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">oJson</span> <span class="o">=</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">if</span> <span class="s1">&#39;stringValue&#39;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">:</span>
                <span class="n">sProcessId</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">oJson</span><span class="p">[</span><span class="s1">&#39;stringValue&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">bAsynch</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">sResult</span> <span class="o">=</span> <span class="n">sProcessId</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sResult</span> <span class="o">=</span> <span class="n">waitProcess</span><span class="p">(</span><span class="n">sProcessId</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalAddFileToWASDI: something broke alongside&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sResult</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-137'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-137'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">subset</span><span class="p">(</span><span class="n">sInputFile</span><span class="p">,</span> <span class="n">sOutputFile</span><span class="p">,</span> <span class="n">dLatN</span><span class="p">,</span> <span class="n">dLonW</span><span class="p">,</span> <span class="n">dLatS</span><span class="p">,</span> <span class="n">dLonE</span><span class="p">):</span>
    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy.subset( &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sInputFile</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sOutputFile</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">dLatN</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dLonW</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dLatS</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dLonE</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; )&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sInputFile</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.subset: input file must not be None, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sInputFile</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.subset: input file name must not have zero length, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">sOutputFile</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.subset: output file must not be None, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sOutputFile</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.subset: output file name len must not have zero length, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">m_sBaseUrl</span> <span class="o">+</span> <span class="s2">&quot;/processing/geometric/subset?sSourceProductName=&quot;</span> <span class="o">+</span> <span class="n">sInputFile</span> <span class="o">+</span> <span class="s2">&quot;&amp;sDestinationProductName=&quot;</span> <span class="o">+</span> \
           <span class="n">sOutputFile</span> <span class="o">+</span> <span class="s2">&quot;&amp;sWorkspaceId=&quot;</span> <span class="o">+</span> <span class="n">m_sActiveWorkspace</span>
    <span class="n">sSubsetSetting</span> <span class="o">=</span> <span class="s2">&quot;{ </span><span class="se">\&quot;</span><span class="s2">latN</span><span class="se">\&quot;</span><span class="s2">:&quot;</span> <span class="o">+</span> <span class="n">dLatN</span> <span class="o">+</span> <span class="s2">&quot;, </span><span class="se">\&quot;</span><span class="s2">lonW</span><span class="se">\&quot;</span><span class="s2">:&quot;</span> <span class="o">+</span> <span class="n">dLonW</span> <span class="o">+</span> <span class="s2">&quot;, </span><span class="se">\&quot;</span><span class="s2">latS</span><span class="se">\&quot;</span><span class="s2">:&quot;</span> <span class="o">+</span> <span class="n">dLatS</span> <span class="o">+</span> <span class="s2">&quot;, </span><span class="se">\&quot;</span><span class="s2">lonE</span><span class="se">\&quot;</span><span class="s2">:&quot;</span> <span class="o">+</span> <span class="n">dLonE</span> <span class="o">+</span> <span class="s2">&quot; }&quot;</span>
    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">oResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">sSubsetSetting</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">oResponse</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.subset: cannot contact server&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.subset: failed, server returned &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">oJson</span> <span class="o">=</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">oJson</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;stringValue&#39;</span> <span class="ow">in</span> <span class="n">oJson</span><span class="p">:</span>
                <span class="n">sProcessId</span> <span class="o">=</span> <span class="n">oJson</span><span class="p">[</span><span class="s1">&#39;stringValue&#39;</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">waitProcess</span><span class="p">(</span><span class="n">sProcessId</span><span class="p">)</span>

    <span class="k">return</span> <span class="s1">&#39;&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-138'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-138'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">executeWorkflow</span><span class="p">(</span><span class="n">asInputFileNames</span><span class="p">,</span> <span class="n">asOutputFileNames</span><span class="p">,</span> <span class="n">sWorkflowName</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_internalExecuteWorkflow</span><span class="p">(</span><span class="n">asInputFileNames</span><span class="p">,</span> <span class="n">asOutputFileNames</span><span class="p">,</span> <span class="n">sWorkflowName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-139'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-139'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">asynchExecuteWorkflow</span><span class="p">(</span><span class="n">asInputFileNames</span><span class="p">,</span> <span class="n">asOutputFileNames</span><span class="p">,</span> <span class="n">sWorkflowName</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_internalExecuteWorkflow</span><span class="p">(</span><span class="n">asInputFileNames</span><span class="p">,</span> <span class="n">asOutputFileNames</span><span class="p">,</span> <span class="n">sWorkflowName</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-140'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-140'>#</a>
      </div>
      <pre><code>Internal call to execute workflow

:param asInputFileNames:
:param asOutputFileNames:
:param sWorkflowName:
:param bAsynch:
:return: processID if asynch, status of the executed process if synch, empty string in case of failure
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">_internalExecuteWorkflow</span><span class="p">(</span><span class="n">asInputFileNames</span><span class="p">,</span> <span class="n">asOutputFileNames</span><span class="p">,</span> <span class="n">sWorkflowName</span><span class="p">,</span> <span class="n">bAsynch</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-141'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-141'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy._internalExecuteWorkflow( &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">asInputFileNames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">asOutputFileNames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sWorkflowName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">bAsynch</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; )&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">asInputFileNames</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: input file names None, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">asInputFileNames</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: no input file names, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="n">asOutputFileNames</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: output file names None, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-142'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-142'>#</a>
      </div>
      <p>elif len(asOutputFileNames) &lt;= 0:
    print(&lsquo;[ERROR] waspy._internalExecuteWorkflow: no output file names, aborting&rsquo;)
    return &lsquo;&rsquo;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">sWorkflowName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: workspace name is None, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sWorkflowName</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: workflow name too short, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="n">sProcessId</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">sWorkflowId</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">getBaseUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;/processing/graph_id?workspace=&quot;</span> <span class="o">+</span> <span class="n">getActiveWorkspaceId</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-143'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-143'>#</a>
      </div>
      <p>get a list of workflows, with entries in this form: :
  {  &ldquo;description&rdquo;:STRING,
      &ldquo;name&rdquo;: STRING,
      &ldquo;workflowId&rdquo;: STRING }</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">aoWorkflows</span> <span class="o">=</span> <span class="n">getWorkflows</span><span class="p">()</span>
    <span class="n">aoDictPayload</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">aoWorkflows</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: workflow list is None, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">aoWorkflows</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: workflow list is empty, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">asWorkflow</span> <span class="ow">in</span> <span class="n">aoWorkflows</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">asWorkflow</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">asWorkflow</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">asWorkflow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">sWorkflowName</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;workflowId&quot;</span> <span class="ow">in</span> <span class="n">asWorkflow</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-144'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-144'>#</a>
      </div>
      <p>replace ' with " everywhere</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                            <span class="n">aoDictPayload</span> <span class="o">=</span> <span class="p">{}</span>
                            <span class="n">aoDictPayload</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">asWorkflow</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span>
                            <span class="n">aoDictPayload</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">asWorkflow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                            <span class="n">aoDictPayload</span><span class="p">[</span><span class="s2">&quot;workflowId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">asWorkflow</span><span class="p">[</span><span class="s2">&quot;workflowId&quot;</span><span class="p">]</span>
                            <span class="k">break</span>
    <span class="k">if</span> <span class="n">aoDictPayload</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: workflow name not found, aborting&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">aoDictPayload</span><span class="p">[</span><span class="s2">&quot;inputFileNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">asInputFileNames</span>
        <span class="n">aoDictPayload</span><span class="p">[</span><span class="s2">&quot;outputFileNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">asOutputFileNames</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: payload could not be generated, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy._internalExecuteWorkflow: about to HTTP put to &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sUrl</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; with payload &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">aoDictPayload</span><span class="p">))</span>
    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">oResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">aoDictPayload</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">oResponse</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: communication with the server failed, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO] waspy._internalExecuteWorkflow: server replied OK&#39;</span><span class="p">)</span>
        <span class="n">asJson</span> <span class="o">=</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;stringValue&quot;</span> <span class="ow">in</span> <span class="n">asJson</span><span class="p">:</span>
            <span class="n">sProcessId</span> <span class="o">=</span> <span class="n">asJson</span><span class="p">[</span><span class="s2">&quot;stringValue&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">bAsynch</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sProcessId</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">waitProcess</span><span class="p">(</span><span class="n">sProcessId</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: cannot find process ID in response, aborting&#39;</span> <span class="o">+</span>
                  <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy._internalExecuteWorkflow: server returned status &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-145'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-145'>#</a>
      </div>
      <pre><code>Constructs a mosaic out of a set of images

:param asInputFiles: List of input files to mosaic
:param sOutputFile: Name of the mosaic output file
:param asBands: List of the bands to use for the mosaic
:param fPixelSizeX: X Pixel Size
:param fPixelSizeY: Y Pixel Size
:param sCrs: WKT of the CRS to use
:param fSouthBound: South Bound
:param fNorthBound: North Bound
:param fEastBound: East Bound
:param fWestBound: West Bound
:param sOverlappingMethod: Overlapping Method
:param bShowSourceProducts: Show Source Products Flag
:param sElevationModelName: DEM Model Name
:param sResamplingName: Resampling Method Name
:param bUpdateMode: Update Mode Flag
:param bNativeResolution: Native Resolution Flag
:param sCombine: Combine verb
:param bAsynch: True to return after the triggering, False to wait the process to finish
:return: Process ID is asynchronous execution, end status otherwise. An empty string is returned in case of failure
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">mosaic</span><span class="p">(</span><span class="n">asInputFiles</span><span class="p">,</span> <span class="n">sOutputFile</span><span class="p">,</span> <span class="n">asBands</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
           <span class="n">fPixelSizeX</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">fPixelSizeY</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sCrs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
           <span class="n">fSouthBound</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">fNorthBound</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">fEastBound</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">fWestBound</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
           <span class="n">sOverlappingMethod</span><span class="o">=</span><span class="s2">&quot;MOSAIC_TYPE_OVERLAY&quot;</span><span class="p">,</span> <span class="n">bShowSourceProducts</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sElevationModelName</span><span class="o">=</span><span class="s2">&quot;ASTER 1sec GDEM&quot;</span><span class="p">,</span>
           <span class="n">sResamplingName</span><span class="o">=</span><span class="s2">&quot;Nearest&quot;</span><span class="p">,</span> <span class="n">bUpdateMode</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">bNativeResolution</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sCombine</span><span class="o">=</span><span class="s2">&quot;OR&quot;</span><span class="p">,</span> <span class="n">bAsynch</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-146'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-146'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">_log</span><span class="p">(</span><span class="s1">&#39;[INFO]  waspy.mosaic( &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">asInputFiles</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">sOutputFile</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">asBands</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">fPixelSizeX</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">fPixelSizeY</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">sCrs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">fSouthBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">fNorthBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">fEastBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">fWestBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">sOverlappingMethod</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">bShowSourceProducts</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">sElevationModelName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">sResamplingName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">bUpdateMode</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">bNativeResolution</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">sCombine</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">bAsynch</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; )&#39;</span>
         <span class="p">)</span>

    <span class="k">if</span> <span class="n">asInputFiles</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.mosaic: list of input files is None, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">asInputFiles</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.mosaic: list of input files is empty, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="n">sOutputFile</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.mosaic: name of output file is None, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sOutputFile</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.mosaic: output file name must be a string, but a &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">sOutputFile</span><span class="p">))</span> <span class="o">+</span>
              <span class="s1">&#39; was passed, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sOutputFile</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.mosaic: output file name is empty, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="n">sUrl</span> <span class="o">=</span> <span class="n">getBaseUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;/processing/geometric/mosaic?sDestinationProductName=&quot;</span> <span class="o">+</span> <span class="n">sOutputFile</span> <span class="o">+</span> <span class="s2">&quot;&amp;sWorkspaceId=&quot;</span> <span class="o">+</span> \
           <span class="n">getActiveWorkspaceId</span><span class="p">()</span>

    <span class="n">sOutputFormat</span> <span class="o">=</span> <span class="s2">&quot;GeoTIFF&quot;</span>
    <span class="k">if</span> <span class="n">sOutputFile</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.dim&quot;</span><span class="p">):</span>
        <span class="n">sOutputFormat</span> <span class="o">=</span> <span class="s2">&quot;BEAM-DIMAP&quot;</span>

    <span class="k">if</span> <span class="n">sCrs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">sCrs</span> <span class="o">=</span> <span class="n">_getDefaultCRS</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-147'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-147'>#</a>
      </div>
      <p>todo check input type is appropriate</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">try</span><span class="p">:</span>
        <span class="n">aoMosaicSettings</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;crs&#39;</span><span class="p">:</span> <span class="n">sCrs</span><span class="p">,</span>
            <span class="s1">&#39;southBound&#39;</span><span class="p">:</span> <span class="n">fSouthBound</span><span class="p">,</span>
            <span class="s1">&#39;eastBound&#39;</span><span class="p">:</span> <span class="n">fEastBound</span><span class="p">,</span>
            <span class="s1">&#39;northBound&#39;</span><span class="p">:</span> <span class="n">fNorthBound</span><span class="p">,</span>
            <span class="s1">&#39;westBound&#39;</span><span class="p">:</span> <span class="n">fWestBound</span><span class="p">,</span>
            <span class="s1">&#39;pixelSizeX&#39;</span><span class="p">:</span> <span class="n">fPixelSizeX</span><span class="p">,</span>
            <span class="s1">&#39;pixelSizeY&#39;</span><span class="p">:</span> <span class="n">fPixelSizeY</span><span class="p">,</span>
            <span class="s1">&#39;overlappingMethod&#39;</span><span class="p">:</span> <span class="n">sOverlappingMethod</span><span class="p">,</span>
            <span class="s1">&#39;showSourceProducts&#39;</span><span class="p">:</span> <span class="n">bShowSourceProducts</span><span class="p">,</span>
            <span class="s1">&#39;elevationModelName&#39;</span><span class="p">:</span> <span class="n">sElevationModelName</span><span class="p">,</span>
            <span class="s1">&#39;resamplingName&#39;</span><span class="p">:</span> <span class="n">sResamplingName</span><span class="p">,</span>
            <span class="s1">&#39;updateMode&#39;</span><span class="p">:</span> <span class="n">bUpdateMode</span><span class="p">,</span>
            <span class="s1">&#39;nativeResolution&#39;</span><span class="p">:</span> <span class="n">bNativeResolution</span><span class="p">,</span>
            <span class="s1">&#39;combine&#39;</span><span class="p">:</span> <span class="n">sCombine</span><span class="p">,</span>
            <span class="s1">&#39;outputFormat&#39;</span><span class="p">:</span> <span class="n">sOutputFormat</span><span class="p">,</span>
            <span class="s1">&#39;sources&#39;</span><span class="p">:</span> <span class="n">asInputFiles</span><span class="p">,</span>
            <span class="s1">&#39;variableNames&#39;</span><span class="p">:</span> <span class="n">asBands</span><span class="p">,</span>
            <span class="s1">&#39;variableExpressions&#39;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.mosaic: cannot build DTO, please check your input. Aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="n">asHeaders</span> <span class="o">=</span> <span class="n">_getStandardHeaders</span><span class="p">()</span>
    <span class="n">oResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">sUrl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">aoMosaicSettings</span><span class="p">),</span> <span class="n">headers</span><span class="o">=</span><span class="n">asHeaders</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">oResponse</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.mosaic: cannot contact server, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">ok</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">asJson</span> <span class="o">=</span> <span class="n">oResponse</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;stringValue&#39;</span> <span class="ow">in</span> <span class="n">asJson</span><span class="p">:</span>
            <span class="n">sProcessId</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">asJson</span><span class="p">[</span><span class="s1">&#39;stringValue&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">bAsynch</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">waitProcess</span><span class="p">(</span><span class="n">sProcessId</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sProcessId</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[ERROR] waspy.mosaic: server respondend with status: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oResponse</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, aborting&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;  ******************************************************************************&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">return</span> <span class="s1">&#39;&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-148'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-148'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">_getDefaultCRS</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">(</span>
            <span class="s2">&quot;GEOGCS[</span><span class="se">\&quot;</span><span class="s2">WGS84(DD)</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\r\n</span><span class="s2">&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;		  DATUM[</span><span class="se">\&quot;</span><span class="s2">WGS84</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\r\n</span><span class="s2">&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;			SPHEROID[</span><span class="se">\&quot;</span><span class="s2">WGS84</span><span class="se">\&quot;</span><span class="s2">, 6378137.0, 298.257223563]], </span><span class="se">\r\n</span><span class="s2">&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;		  PRIMEM[</span><span class="se">\&quot;</span><span class="s2">Greenwich</span><span class="se">\&quot;</span><span class="s2">, 0.0], </span><span class="se">\r\n</span><span class="s2">&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;		  UNIT[</span><span class="se">\&quot;</span><span class="s2">degree</span><span class="se">\&quot;</span><span class="s2">, 0.017453292519943295], </span><span class="se">\r\n</span><span class="s2">&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;		  AXIS[</span><span class="se">\&quot;</span><span class="s2">Geodetic longitude</span><span class="se">\&quot;</span><span class="s2">, EAST], </span><span class="se">\r\n</span><span class="s2">&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;		  AXIS[</span><span class="se">\&quot;</span><span class="s2">Geodetic latitude</span><span class="se">\&quot;</span><span class="s2">, NORTH]]&quot;</span>
    <span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">_log</span><span class="p">(</span>
        <span class="s1">&#39;WASPY - The WASDI Python Library. Include in your code for space development processors. Visit www.wasdi.net&#39;</span>
    <span class="p">)</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
